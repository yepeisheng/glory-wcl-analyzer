(function(t){function e(e){for(var i,s,l=e[0],o=e[1],c=e[2],d=0,b=[];d<l.length;d++)s=l[d],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&b.push(r[s][0]),r[s]=0;for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i]);u&&u(e);while(b.length)b.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var t,e=0;e<n.length;e++){for(var a=n[e],i=!0,l=1;l<a.length;l++){var o=a[l];0!==r[o]&&(i=!1)}i&&(n.splice(e--,1),t=s(s.s=a[0]))}return t}var i={},r={app:0},n=[];function s(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=i,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(a,i,function(e){return t[e]}.bind(null,i));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],o=l.push.bind(l);l.push=e,l=l.slice();for(var c=0;c<l.length;c++)e(l[c]);var u=o;n.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"31ed":function(t,e,a){"use strict";var i=a("8e4e"),r=a.n(i);r.a},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var i=a("2b0e"),r=a("ce5b"),n=a.n(r),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-app-bar",{attrs:{app:""}},[a("v-toolbar-title",[t._v(" "+t._s(t.title)+" ")]),a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:function(e){t.openSetting=!t.openSetting}}},[a("v-icon",[t._v("mdi-settings-box")])],1)],1),a("v-main",[a("v-container",{attrs:{fluid:""}},[a("v-dialog",{attrs:{"max-width":"1000"},model:{value:t.openTable,callback:function(e){t.openTable=e},expression:"openTable"}},[a("wcl-table",{attrs:{table:t.table}})],1),a("v-slide-y-transition",[a("setting",{directives:[{name:"show",rawName:"v-show",value:t.openSetting,expression:"openSetting"}]})],1),a("v-row",{directives:[{name:"show",rawName:"v-show",value:!t.openSetting,expression:"!openSetting"}]},[a("v-col",{staticClass:"col-5 offset-3"},[a("v-text-field",{attrs:{loading:t.loading,disabled:t.loading,label:"wcl report id"},model:{value:t.reportId,callback:function(e){t.reportId=e},expression:"reportId"}})],1),a("v-col",{attrs:{"align-self":"center"}},[a("v-btn",{attrs:{disabled:t.loading},on:{click:t.fetchReport}},[t._v("Fetch")])],1)],1),a("v-row",{directives:[{name:"show",rawName:"v-show",value:!t.openSetting,expression:"!openSetting"}]},[a("v-col",{staticClass:"col-6 offset-3"},[a("score-table",{attrs:{scores:t.scores},on:{openTable:t.openTablePanel}})],1)],1)],1)],1),a("v-footer",{attrs:{app:""}},[t._v(" "+t._s(t.footer)+" ")])],1)},l=[],o=(a("99af"),a("4de4"),a("7db0"),a("a630"),a("d81d"),a("13d5"),a("d3b7"),a("6062"),a("3ca3"),a("ddb0"),a("2909")),c=(a("96cf"),a("1da1")),u=a("5530"),d=a("40dc"),b=a("2fa4"),p=a("0789"),f=a("2a7f"),m=a("a523"),v=a("f6c4"),g=a("553a"),h=a("8654"),T=a("8336"),y=a("132d"),_=a("2f62"),E=(a("07ac"),"2dd31d65c33dabb5d269c9d24c4a14ed"),S="api_key=".concat(E,"&translate=true"),O="https://cn.classic.warcraftlogs.com/v1",I={SUMMARY:"summary",DAMAGE:"damage-done",DAMAGE_TAKEN:"damage-taken",HEALING:"healing",CASTS:"casts",SUMMONS:"summons",BUFFS:"buffs",DEBUFFS:"debuffs",DEATHS:"deaths",SURVIVABILITY:"survivability",RESOURCES:"resources",RESOURCE_GAINS:"resources-gains"},x={OVERALL:"全程",BEFORE_ONE:"四狗+三鸡",ONE:"预言者斯克拉姆",BEFORE_TWO:"三宝前",TWO:"安其拉三宝",BEFORE_THREE:"通道虫",THREE:"沙尔图拉",BEFORE_FOUR:"陷阱房",FOUR:"顽强的范克瑞斯",FIVE:"维希度斯",BEFORE_SIX:"蜜蜂房",SIX:"哈霍兰公主",BEFORE_SEVEN:"五狗",SEVEN:"双子皇帝",BEFORE_EIGHT:"天堂之路",EIGHT:"奥罗",NINE:"克苏恩"},A={TOTAL:"total",HIT:"hitCount",BUFF_TOTAL:"totalUses"},V={total:"总数值",hitCount:"命中数",totalUses:"BUFF数"};function w(t){return N.apply(this,arguments)}function N(){return N=Object(c["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(O,"/report/fights/").concat(e,"?").concat(S));case 2:return a=t.sent,t.next=5,a.json();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)}))),N.apply(this,arguments)}function L(t,e,a,i,r,n){return R.apply(this,arguments)}function R(){return R=Object(c["a"])(regeneratorRuntime.mark((function t(e,a,i,r,n,s){var l,o,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return l=S,s["abilityId"]&&(l="".concat(l,"&abilityid=").concat(s["abilityId"])),s["customQuery"]&&(l="".concat(l,"&").concat(s["customQuery"])),t.next=5,fetch("".concat(O,"/report/tables/").concat(a,"/").concat(e,"?start=").concat(i,"&end=").concat(r,"&").concat(l));case 5:return o=t.sent,t.next=8,o.json();case 8:return c=t.sent,t.abrupt("return",(a===I.BUFFS?c["auras"]:c["entries"]).map((function(t){return Object(u["a"])(Object(u["a"])({},t),{},{total:t[n]})})));case 10:case"end":return t.stop()}}),t)}))),R.apply(this,arguments)}function C(t){var e;return Object.values((e=[]).concat.apply(e,Object(o["a"])(t)).reduce((function(t,e){return void 0===t[e.id]?t[e.id]=e:t[e.id].total+=e.total,t}),{}))}function j(t){var e;return Object.values((e=[]).concat.apply(e,Object(o["a"])(t)).reduce((function(t,e){return void 0===t[e.id]?t[e.id]=Object(u["a"])(Object(u["a"])({},e),{},{total:1}):t[e.id].total+=1,t}),{}))}a("c740"),a("fb6a"),a("a434");var k=[{id:"DAMAGE",predefined:!0,displayName:"全程伤害",tableName:I.DAMAGE,fights:x.OVERALL,column:A.TOTAL,abilityIds:[],customQuery:""},{id:"DAMAGE-TAKEN",predefined:!0,displayName:"全程承伤",tableName:I.DAMAGE_TAKEN,fights:x.OVERALL,column:A.TOTAL,abilityIds:[],customQuery:""},{id:"HEALING",predefined:!0,displayName:"全程自疗",tableName:I.HEALING,fights:x.OVERALL,column:A.TOTAL,abilityIds:[],customQuery:""},{id:"WORLD-BUFFS",predefined:!0,displayName:"世界BUFFS",tableName:I.BUFFS,fights:x.OVERALL,column:A.BUFF_TOTAL,abilityIds:[15366,22888,22818,24425,22817,16609],customQuery:""},{id:"DUMMY-TARGET",predefined:!0,displayName:"高级活动假人",tableName:I.CASTS,fights:x.OVERALL,column:A.TOTAL,abilityIds:[19805],customQuery:""},{id:"SUNDERS",predefined:!0,displayName:"破甲",tableName:I.CASTS,fights:x.OVERALL,column:A.TOTAL,abilityIds:[11597],customQuery:""},{id:"VIS",predefined:!0,displayName:"维希度斯冰箭",tableName:I.DAMAGE,fights:x.FIVE,column:A.HIT,abilityIds:[13439,205],customQuery:""},{id:"petrification",predefined:!0,displayName:"化石",tableName:I.CASTS,fights:x.OVERALL,column:A.TOTAL,abilityIds:[17624],customQuery:""},{id:"poison",predefined:!0,displayName:"抗毒药剂",tableName:I.CASTS,fights:x.OVERALL,column:A.TOTAL,abilityIds:[26677],customQuery:""},{id:"TEAMMATE-DAMAGE",predefined:!0,displayName:"队友误伤",tableName:I.DAMAGE_TAKEN,fights:x.OVERALL,column:A.TOTAL,abilityIds:[],customQuery:"hostility=1&sourceclass=Player&target=Player&by=target"},{id:"death-wish-1",predefined:!0,displayName:"老1前死愿+鲁莽",tableName:I.CASTS,fights:x.BEFORE_ONE,column:A.TOTAL,abilityIds:[12328,-1719],customQuery:""},{id:"death-wish-2",predefined:!0,displayName:"三宝前死愿",tableName:I.CASTS,fights:x.BEFORE_TWO,column:A.TOTAL,abilityIds:[12328],customQuery:""},{id:"death-wish-3",predefined:!0,displayName:"沙尔图拉死愿",tableName:I.CASTS,fights:x.THREE,column:A.TOTAL,abilityIds:[12328],customQuery:""},{id:"death-wish-4",predefined:!0,displayName:"哈霍兰死愿",tableName:I.CASTS,fights:x.SIX,column:A.TOTAL,abilityIds:[12328],customQuery:""},{id:"death-wish-5",predefined:!0,displayName:"奥罗死愿鲁莽",tableName:I.CASTS,fights:x.EIGHT,column:A.TOTAL,abilityIds:[12328,-1719],customQuery:""}],F={RELATIVE_TO_TOP:"to_top",RELATIVE_TO_MAX:"to_max",RELATIVE_TO_AVG:"to_avg",RELATIVE_TO_TOTAL:"to_total",UNITARY:"unitary"},M={to_top:"相对于第一名",to_max:"相对于预设值",to_avg:"相对于平均",to_total:"相对于总数",unitary:"转换成0或1"},G=[{displayName:"熟练度",edit:!1,weight:.5,subGroups:[{tableId:"DAMAGE",weight:1,type:F.RELATIVE_TO_TOP},{tableId:"TEAMMATE-DAMAGE",weight:-.2,type:F.RELATIVE_TO_MAX,max:3e3},{tableId:"HEALING",type:F.RELATIVE_TO_TOP,weight:.1},{tableId:"SUNDERS",weight:.3,type:F.RELATIVE_TO_TOP}]},{displayName:"战术",edit:!1,weight:.5,subGroups:[{tableId:"DUMMY-TARGET",weight:.25,type:F.RELATIVE_TO_MAX,max:3},{tableId:"VIS",weight:.25,type:F.RELATIVE_TO_AVG},{tableId:"death-wish-1",weight:.25,type:F.RELATIVE_TO_MAX,max:2},{tableId:"death-wish-2",weight:.25,type:F.RELATIVE_TO_MAX,max:1},{tableId:"death-wish-3",weight:.25,type:F.RELATIVE_TO_MAX,max:1},{tableId:"death-wish-4",weight:.25,type:F.RELATIVE_TO_MAX,max:1},{tableId:"death-wish-5",weight:.25,type:F.RELATIVE_TO_MAX,max:2}]},{displayName:"投入",edit:!1,weight:.5,subGroups:[{tableId:"WORLD-BUFFS",type:F.RELATIVE_TO_MAX,max:6,weight:1},{tableId:"petrification",type:F.RELATIVE_TO_TOP,weight:1},{tableId:"poison",type:F.RELATIVE_TO_AVG,weight:1}]}],B=function(){return{tables:localStorage.getItem("gloryWCLSetting-tables")?JSON.parse(localStorage.getItem("gloryWCLSetting-tables")):k.slice(),formulas:localStorage.getItem("gloryWCLSetting-formulas")?JSON.parse(localStorage.getItem("gloryWCLSetting-formulas")):G.slice()}},U={},D={},W={updateTable:function(t,e){var a=t.tables.findIndex((function(t){return t.id===e.id}));i["default"].set(t.tables,a,e),localStorage.setItem("gloryWCLSetting-tables",JSON.stringify(t.tables))},insertTable:function(t,e){t.tables.push(e),localStorage.setItem("gloryWCLSetting-tables",JSON.stringify(t.tables))},deleteTable:function(t,e){var a=t.tables.findIndex((function(t){return t.id===e}));t.tables.splice(a,1),localStorage.setItem("gloryWCLSetting-tables",JSON.stringify(t.tables))},resetTable:function(t){t.tables=k,localStorage.setItem("gloryWCLSetting-tables",JSON.stringify(t.tables))},insertFormula:function(t,e){t.formulas.unshift(e),localStorage.setItem("gloryWCLSetting-formulas",JSON.stringify(t.formulas))},deleteFormula:function(t,e){t.formulas.splice(e,1),localStorage.setItem("gloryWCLSetting-formulas",JSON.stringify(t.formulas))},resetFormula:function(t){t.formulas=G,localStorage.setItem("gloryWCLSetting-formulas",JSON.stringify(t.formulas))},insertSubgroup:function(t,e){var a=e.formulaIdx,i=e.newSubgroup;t.formulas[a].unshift(i),localStorage.setItem("gloryWCLSetting-formulas",JSON.stringify(t.formulas))},updateSubgroup:function(t,e){var a=e.formulaIdx,r=e.subgroupIdx,n=e.subgroup;i["default"].set(t.formulas[a].subGroups,r,n),localStorage.setItem("gloryWCLSetting-formulas",JSON.stringify(t.formulas))},deleteSubgroup:function(t,e){var a=e.formulaIdx,i=e.subgroupIdx;t.formulas[a].subGroups.splice(i,1),localStorage.setItem("gloryWCLSetting-formulas",t.formulas.slice())}},P={namespaced:!0,state:B,getters:U,actions:D,mutations:W},Q=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{staticClass:"settings",attrs:{elevation:"4",width:"100%"}},[a("v-toolbar",{scopedSlots:t._u([{key:"extension",fn:function(){return[a("v-tabs",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tabs-slider",{attrs:{color:"primary"}}),a("v-tab",[t._v("表格")]),a("v-tab",[t._v("分数公式")])],1)]},proxy:!0}])},[a("v-toolbar-title",[t._v(" 设置 ")])],1),a("v-tabs-items",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tab-item",[a("v-container",{attrs:{fluid:""}},[a("v-dialog",{attrs:{"max-width":"400",persistent:""},model:{value:t.tableEditor,callback:function(e){t.tableEditor=e},expression:"tableEditor"}},[a("v-card",[a("v-card-title",[t._v("表格")]),a("v-card-text",[a("v-text-field",{attrs:{label:"表格名称"},model:{value:t.editTable.displayName,callback:function(e){t.$set(t.editTable,"displayName",e)},expression:"editTable.displayName"}}),a("v-select",{attrs:{label:"表格类型",items:t.tableTypeSelect},model:{value:t.editTable.tableName,callback:function(e){t.$set(t.editTable,"tableName",e)},expression:"editTable.tableName"}}),a("v-select",{attrs:{label:"战斗",items:t.fightSelect},model:{value:t.editTable.fights,callback:function(e){t.$set(t.editTable,"fights",e)},expression:"editTable.fights"}}),a("v-select",{attrs:{label:"表格列",items:t.columnSelect},model:{value:t.editTable.column,callback:function(e){t.$set(t.editTable,"column",e)},expression:"editTable.column"}}),a("v-text-field",{attrs:{label:"法术ID",rules:[function(){return 0===t.editTable.abilityIds.length||t.editTable.abilityIds.split(",").every((function(t){return!isNaN(parseInt(t))}))||"必须为以,隔开的数字"}]},model:{value:t.editTable.abilityIds,callback:function(e){t.$set(t.editTable,"abilityIds",e)},expression:"editTable.abilityIds"}}),a("v-text-field",{attrs:{label:"自定义参数"},model:{value:t.editTable.customQuery,callback:function(e){t.$set(t.editTable,"customQuery",e)},expression:"editTable.customQuery"}})],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary"},on:{click:t.saveTable}},[t._v("确定")]),a("v-btn",{on:{click:function(e){t.tableEditor=!1}}},[t._v("CLOSE")])],1)],1)],1),a("v-row",[a("v-col",[a("v-btn",{on:{click:t.newTable}},[a("v-icon",{attrs:{left:""}},[t._v(" mdi-plus ")]),t._v(" 添加表格")],1),a("v-btn",{staticClass:"ml-2",on:{click:t.resetTable}},[a("v-icon",{attrs:{left:""}},[t._v(" mdi-refresh ")]),t._v(" 重置")],1)],1)],1),a("v-row",[a("v-col",[a("v-simple-table",{attrs:{"fixed-header":""},scopedSlots:t._u([{key:"default",fn:function(){return[a("thead",[a("tr",[a("th",{staticClass:"text-left"},[t._v("表格名字")]),a("th",{staticClass:"text-left"},[t._v("表格类型")]),a("th",{staticClass:"text-left"},[t._v("战斗")]),a("th",{staticClass:"text-left"},[t._v("表格列")]),a("th",{staticClass:"text-left"},[t._v("法术ID")]),a("th",{staticClass:"text-left"},[t._v("自定义参数")]),a("th",{staticClass:"text-left",staticStyle:{width:"170px"}},[t._v("操作")])])]),a("tbody",t._l(t.tables,(function(e){return a("tr",{key:e.id},[a("td",{staticClass:"text-left"},[t._v(" "+t._s(e.displayName)+" ")]),a("td",{staticClass:"text-left"},[t._v(" "+t._s(e.tableName)+" ")]),a("td",{staticClass:"text-left"},[t._v(" "+t._s(e.fights)+" ")]),a("td",{staticClass:"text-left"},[t._v(" "+t._s(t.COLUMN_TEXT[e.column])+" ")]),a("td",{staticClass:"text-left"},[t._v(" "+t._s(void 0!==e.abilityIds?e.abilityIds.join(", "):"")+" ")]),a("td",{staticClass:"text-left"},[t._v(" "+t._s(e.customQuery)+" ")]),a("td",[a("v-btn",{on:{click:function(a){return t.edit(e)}}},[t._v("修改")]),e.predefined?t._e():a("v-btn",{staticClass:"ml-2",attrs:{color:"accent"},on:{click:function(a){return t.deleteTable(e.id)}}},[t._v("删除")])],1)])})),0)]},proxy:!0}])})],1)],1)],1)],1),a("v-tab-item",[a("v-container",{attrs:{fluid:""}},[a("v-dialog",{attrs:{"max-width":"400",persistent:""},model:{value:t.formulaEditor,callback:function(e){t.formulaEditor=e},expression:"formulaEditor"}},[a("v-card",[a("v-card-title",[t._v("计分组")]),a("v-card-text",[a("v-text-field",{attrs:{label:"计分组名称"},model:{value:t.editFormula.displayName,callback:function(e){t.$set(t.editFormula,"displayName",e)},expression:"editFormula.displayName"}})],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary"},on:{click:t.saveFormula}},[t._v("确定")]),a("v-btn",{on:{click:function(e){t.formulaEditor=!1}}},[t._v("CLOSE")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"400",persistent:""},model:{value:t.subgroupEditor,callback:function(e){t.subgroupEditor=e},expression:"subgroupEditor"}},[a("v-card",[a("v-card-title",[t._v("计分")]),a("v-card-text",[a("v-select",{attrs:{label:"表格",items:t.tableSelect},model:{value:t.editSubgroup.tableId,callback:function(e){t.$set(t.editSubgroup,"tableId",e)},expression:"editSubgroup.tableId"}}),a("v-select",{attrs:{label:"计分方式",items:t.typeSelect},model:{value:t.editSubgroup.type,callback:function(e){t.$set(t.editSubgroup,"type",e)},expression:"editSubgroup.type"}}),a("v-text-field",{attrs:{label:"预设值",rules:[function(){return!isNaN(parseInt(t.editSubgroup.max))||"必须为正整数"}]},model:{value:t.editSubgroup.max,callback:function(e){t.$set(t.editSubgroup,"max",e)},expression:"editSubgroup.max"}})],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary"},on:{click:t.saveSubgroup}},[t._v("确定")]),a("v-btn",{on:{click:function(e){t.subgroupEditor=!1}}},[t._v("CLOSE")])],1)],1)],1),a("v-row",[a("v-col",[a("v-btn",{on:{click:t.newFormula}},[a("v-icon",{attrs:{left:""}},[t._v(" mdi-plus ")]),t._v("添加组")],1),a("v-btn",{staticClass:"ml-2",on:{click:t.resetTable}},[a("v-icon",{attrs:{left:""}},[t._v(" mdi-refresh ")]),t._v("重置")],1)],1)],1),a("v-row",[a("v-col",t._l(t.formulas,(function(e,i){return a("v-card",{key:i,staticClass:"mb-2",attrs:{elevation:"3"}},[a("v-card-title",{staticClass:"text--primary"},[a("v-row",[a("v-col",{staticClass:"col-1 d-flex align-center"},[e.edit?[a("v-text-field",{attrs:{"hide-details":"",dense:""},model:{value:e.displayName,callback:function(a){t.$set(e,"displayName",a)},expression:"group.displayName"}}),a("v-btn",{attrs:{icon:""},on:{click:function(t){e.edit=!1}}},[a("v-icon",[t._v("mdi-check")])],1)]:[t._v(" "+t._s(e.displayName)+" "),a("v-btn",{attrs:{icon:""},on:{click:function(t){e.edit=!0}}},[a("v-icon",[t._v(" mdi-pencil ")])],1)]],2),a("v-col",{staticClass:"col-2 py-0 align-center d-flex"},[a("v-slider",{attrs:{dense:"","hide-details":"",min:"-1",max:"1",step:"0.05",color:"primary"},model:{value:e.weight,callback:function(a){t.$set(e,"weight",a)},expression:"group.weight"}})],1),a("v-col",[t._v(" 比重: "+t._s(e.weight)+" ")]),a("v-col",{staticClass:"d-flex justify-end"},[a("v-btn",{attrs:{fab:"",small:"",color:"accent"},on:{click:function(e){return t.deleteFormula(i)}}},[a("v-icon",[t._v("mdi-delete")])],1)],1)],1)],1),a("v-card-text",[a("v-row",[a("v-col",[a("v-btn",{on:{click:function(e){return t.newSubgroup(i)}}},[a("v-icon",{attrs:{left:""}},[t._v(" mdi-plus ")]),t._v("添加计分")],1)],1)],1),a("v-row",[a("v-col",[a("v-simple-table",{scopedSlots:t._u([{key:"default",fn:function(){return[a("thead",[a("tr",[a("th",{staticStyle:{width:"300px"}},[t._v("表格")]),a("th",{staticStyle:{width:"300px"}},[t._v("算分方式")]),a("th",{staticStyle:{width:"300px"}},[t._v("预设值")]),a("th",[t._v("比重")]),a("th",{staticStyle:{width:"170px"}},[t._v("操作")])])]),a("tbody",t._l(e.subGroups,(function(e,r){return a("tr",{key:i+"_"+r},[a("td",[t._v(" "+t._s(t.tables.find((function(t){return t.id===e.tableId})).displayName)+" ")]),a("td",[t._v(t._s(t.FORMULA_TYPE_TEXT[e.type]))]),a("td",[t._v(t._s(e.max))]),a("td",[a("v-row",[a("v-col",{staticClass:"col-1 d-flex align-center"},[t._v(t._s(e.weight))]),a("v-col",[a("v-slider",{attrs:{dense:"","hide-details":"",min:"-1",max:"1",step:"0.05",color:"primary"},model:{value:e.weight,callback:function(a){t.$set(e,"weight",a)},expression:"sub.weight"}})],1)],1)],1),a("td",[a("v-btn",{on:{click:function(e){return t.openEditSubgroup(i,r)}}},[t._v("修改")]),a("v-btn",{staticClass:"ml-2",attrs:{color:"accent"},on:{click:function(e){return t.deleteSubgroup(i,r)}}},[t._v("删除")])],1)])})),0)]},proxy:!0}],null,!0)})],1)],1)],1)],1)})),1)],1)],1)],1)],1)],1)},X=[],$=(a("a15b"),a("ac1f"),a("1276"),a("ec26")),H=a("ba0d"),J=a("71d9"),Y=a("1f4f"),K=a("b0af"),q=a("99d9"),z=a("169a"),Z=a("b974"),tt=a("fe57"),et=a("9a96"),at=a("71a3"),it={name:"Setting",components:{VSlider:H["a"],VIcon:y["a"],VContainer:m["a"],VToolbar:J["a"],VToolbarTitle:f["a"],VSimpleTable:Y["a"],VCard:K["a"],VCardTitle:q["c"],VCardActions:q["a"],VCardText:q["b"],VDialog:z["a"],VSelect:Z["a"],VTabs:tt["a"],VTabsSlider:et["a"],VTab:at["a"],VSpacer:b["a"]},data:function(){return{tab:0,tableEditor:!1,formulaEditor:!1,subgroupEditor:!1,tableTypeSelect:Object.values(I).map((function(t){return{text:t,value:t}})),fightSelect:Object.values(x).map((function(t){return{text:t,value:t}})),typeSelect:Object.values(F).map((function(t){return{text:M[t],value:t}})),COLUMN_TEXT:V,FORMULA_TYPE_TEXT:M,columnSelect:Object.values(A).map((function(t){return{text:V[t],value:t}})),editTable:{predefined:!1,displayName:"",tableName:I.DAMAGE_TAKEN,fights:x.OVERALL,column:A.TOTAL,abilityIds:[],customQuery:""},editFormula:{displayName:"",edit:!1,weight:1,subGroups:[]},editSubgroupIdx:{formulaIdx:-1,subgroupIdx:-1},editSubgroup:{tableId:"DAMAGE",weight:1,type:F.RELATIVE_TO_TOP},editFormulaMode:"edit",editSubgroupMode:"edit",editTableMode:"edit"}},computed:Object(u["a"])(Object(u["a"])({},Object(_["c"])("config",["tables","formulas"])),{},{tableSelect:function(){return this.tables.map((function(t){return{text:t.displayName,value:t.id}}))}}),methods:Object(u["a"])(Object(u["a"])({},Object(_["b"])("config",["insertTable","updateTable","deleteTable","resetTable","insertFormula","deleteFormula","resetFormula","insertSubgroup","updateSubgroup","deleteSubgroup"])),{},{edit:function(t){this.editTable=Object.assign({},t,{abilityIds:void 0!==t.abilityIds?t.abilityIds.join(","):""}),this.editTableMode="edit",this.tableEditor=!0},openEditSubgroup:function(t,e){this.editSubgroup=Object.assign({},this.formulas[t].subGroups[e]),this.editSubgroupIdx={formulaIdx:t,subgroupIdx:e},this.editSubgroupMode="edit",this.subgroupEditor=!0},newTable:function(){this.editTable={id:Object($["a"])(),predefined:!1,displayName:"",tableName:I.DAMAGE_TAKEN,fights:x.OVERALL,column:A.TOTAL,abilityIds:"",customQuery:""},this.editTableMode="new",this.tableEditor=!0},newFormula:function(){this.editFormula={displayName:"",edit:!1,weight:1,subGroups:[]},this.editFormulaMode="new",this.formulaEditor=!0},newSubgroup:function(t){this.editSubgroup={tableId:"DAMAGE",weight:1,type:F.RELATIVE_TO_TOP},this.editSubgroupIdx.formulaIdx=t,this.editSubgroupMode="new",this.subgroupEditor=!0},saveFormula:function(){this.insertFormula(this.editFormula),this.formulaEditor=!1},saveSubgroup:function(){"new"===this.editSubgroupMode?this.insertSubgroup(Object(u["a"])(Object(u["a"])({},this.editSubgroupIdx),{},{subgroup:Object(u["a"])(Object(u["a"])({},this.editSubgroup),{},{max:parseInt(this.editSubgroup.max)})})):"edit"===this.editSubgroupMode&&this.updateSubgroup(Object(u["a"])(Object(u["a"])({},this.editSubgroupIdx),{},{subgroup:Object(u["a"])(Object(u["a"])({},this.editSubgroup),{},{max:parseInt(this.editSubgroup.max)})})),this.subgroupEditor=!1,console.log(this.formulas)},saveTable:function(){"new"===this.editTableMode?this.insertTable(Object(u["a"])(Object(u["a"])({},this.editTable),{},{abilityIds:this.editTable.abilityIds.split(",")})):"edit"===this.editTableMode&&this.updateTable(Object(u["a"])(Object(u["a"])({},this.editTable),{},{abilityIds:this.editTable.abilityIds.split(",")})),this.tableEditor=!1}})},rt=it,nt=(a("31ed"),a("2877")),st=a("6544"),lt=a.n(st),ot=a("62ad"),ct=a("0fd9"),ut=a("c671"),dt=a("aac8"),bt=Object(nt["a"])(rt,Q,X,!1,null,null,null),pt=bt.exports;lt()(bt,{VBtn:T["a"],VCard:K["a"],VCardActions:q["a"],VCardText:q["b"],VCardTitle:q["c"],VCol:ot["a"],VContainer:m["a"],VDialog:z["a"],VIcon:y["a"],VRow:ct["a"],VSelect:Z["a"],VSimpleTable:Y["a"],VSlider:H["a"],VSpacer:b["a"],VTab:at["a"],VTabItem:ut["a"],VTabs:tt["a"],VTabsItems:dt["a"],VTabsSlider:et["a"],VTextField:h["a"],VToolbar:J["a"],VToolbarTitle:f["a"]});var ft=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-list",{attrs:{width:"100%"}},t._l(t.scores,(function(e){return a("v-list-group",{key:e.id,scopedSlots:t._u([{key:"activator",fn:function(){return[a("v-list-item-content",[a("v-list-item-title",[t._v(t._s(e.name)+" - "+t._s(Math.round(10*e.totalScore)/10))])],1)]},proxy:!0}],null,!0)},t._l(e.detailScore,(function(i,r){return a("v-list-group",{key:e.id+"-"+r,attrs:{"no-action":"","sub-group":""},scopedSlots:t._u([{key:"activator",fn:function(){return[a("v-list-item",[a("v-list-item-content",[a("v-list-item-title",[t._v(t._s(i.displayName)+" - "+t._s(Math.round(10*i.score)/10))])],1)],1)]},proxy:!0}],null,!0)},t._l(i.subGroups,(function(i){return a("v-list-item",{key:e.id+"-"+i.tableId,on:{click:function(e){return t.$emit("openTable",i.tableId)}}},[a("v-list-item-content",[a("v-list-item-title",[t._v(t._s(i.tableName)+" - "+t._s(Math.round(10*i.score)/10))])],1)],1)})),1)})),1)})),1)],1)},mt=[],vt=a("8860"),gt=a("56b0"),ht=a("da13"),Tt=a("5d23"),yt={name:"ScoreTable",components:{VList:vt["a"],VListGroup:gt["a"],VListItem:ht["a"],VListItemContent:Tt["a"]},props:{scores:{type:Array,required:!0}}},_t=yt,Et=Object(nt["a"])(_t,ft,mt,!1,null,null,null),St=Et.exports;lt()(Et,{VList:vt["a"],VListGroup:gt["a"],VListItem:ht["a"],VListItemContent:Tt["a"],VListItemTitle:Tt["b"]});var Ot=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{staticClass:"settings",attrs:{elevation:"4",width:"100%",height:"100%"}},[a("v-toolbar",[a("v-toolbar-title",[t._v(" "+t._s(t.table.tableName)+" ")])],1),a("v-container",{attrs:{fluid:""}},[a("v-simple-table",{attrs:{"fixed-header":"",height:"500px"},scopedSlots:t._u([{key:"default",fn:function(){return[a("thead",[a("tr",[a("th",{staticClass:"text-left"},[t._v("名字")]),a("th",{staticClass:"text-left"},[t._v("百分条")]),a("th",{staticClass:"text-left"},[t._v("数值")])])]),a("tbody",t._l(t.table.entries,(function(e){return a("tr",{key:e.id},[a("td",[t._v(t._s(e.name))]),a("td",{staticStyle:{width:"600px"}},[a("div",{staticClass:"primary",staticStyle:{height:"25px"},style:{width:e.total/t.table.TOP*580+"px"}})]),a("td",[t._v(t._s(e.total))])])})),0)]},proxy:!0}])})],1)],1)},It=[],xt={name:"WclTable",components:{VContainer:m["a"],VToolbar:J["a"],VToolbarTitle:f["a"],VSimpleTable:Y["a"],VCard:K["a"]},props:{table:{type:Object,required:!0}},methods:{}},At=xt,Vt=Object(nt["a"])(At,Ot,It,!1,null,null,null),wt=Vt.exports;lt()(Vt,{VCard:K["a"],VContainer:m["a"],VSimpleTable:Y["a"],VToolbar:J["a"],VToolbarTitle:f["a"]});var Nt={name:"App",components:{ScoreTable:St,VAppBar:d["a"],VSpacer:b["a"],VSlideYTransition:p["f"],VToolbarTitle:f["a"],VContainer:m["a"],VMain:v["a"],VFooter:g["a"],VTextField:h["a"],VBtn:T["a"],Setting:pt,WclTable:wt,VIcon:y["a"]},data:function(){return{openSetting:!1,openTable:!1,table:{},loading:!1,title:"Classic WCL Analyzer",footer:"Powered by To God be the Glory",reportId:"apz2cHtjXKBvYR8r",scores:[]}},computed:Object(u["a"])(Object(u["a"])({},Object(_["c"])("config",["tables","formulas"])),Object(_["c"])("report",["friendlies","fights","tableEntries"])),watch:{},methods:Object(u["a"])(Object(u["a"])({},Object(_["b"])("report",["setReport","setTableEntries"])),{},{openTablePanel:function(t){this.openTable=!0,this.table=this.tableEntries[t]},fetchReport:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var a,i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,e.next=3,w(t.reportId);case 3:return i=e.sent,t.setReport(i),r=new Set((a=[]).concat.apply(a,Object(o["a"])(t.formulas.map((function(t){return t.subGroups})))).map((function(t){return t.tableId}))),e.next=8,t.fetchTables(Array.from(r));case 8:return e.next=10,t.calcScores(t.friendlies.filter((function(t){return"Warrior"===t.type})),t.tableEntries);case 10:t.loading=!1;case 11:case"end":return e.stop()}}),e)})))()},fetchTables:function(t){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Promise.all(t.map(function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(a){var i,r,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i=e.tables.find((function(t){return t.id===a})),r=e.fights[i.fights],!(i.abilityIds.length>0)){t.next=9;break}return t.next=5,Promise.all(i.abilityIds.map((function(t){return L(e.reportId,i.tableName,r["start_time"],r["end_time"],i.column,{abilityId:t,customQuery:i.customQuery})})));case 5:return n=t.sent,t.abrupt("return",{tableId:a,tableName:i.displayName,entries:"WORLD-BUFFS"===a?j(n):C(n)});case 9:return t.next=11,L(e.reportId,i.tableName,r["start_time"],r["end_time"],i.column,{customQuery:i.customQuery});case 11:return s=t.sent,t.abrupt("return",{tableId:a,tableName:i.displayName,entries:s});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 2:i=a.sent,e.setTableEntries(i);case 4:case"end":return a.stop()}}),a)})))()},calcScores:function(t,e){var a=this;return Object(c["a"])(regeneratorRuntime.mark((function i(){var r,n,s;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:a.scores=[],r=a.formulas.reduce((function(t,e){return e.weight>0?t+e.weight:t}),0),n=a.formulas.map((function(t){var e=t.subGroups.reduce((function(t,e){return e.weight>0?t+e.weight:t}),0);return Object(u["a"])(Object(u["a"])({},t),{},{weight:t.weight/r,subGroups:t.subGroups.map((function(t){return Object(u["a"])(Object(u["a"])({},t),{},{weight:t.weight/e})}))})})),s=t.map((function(t){var a=n.map((function(a){var i=a.subGroups.map((function(a){return Object(u["a"])(Object(u["a"])({},a),{},{tableName:e[a.tableId].tableName,score:function(){var i=e[a.tableId],r=i.entries.find((function(e){return e.id===t.id})),n=void 0===r?0:r.total;switch(a.type){case F.RELATIVE_TO_MAX:return n/a.max;case F.RELATIVE_TO_TOP:return n/i.TOP;case F.RELATIVE_TO_AVG:return n/i.AVG;case F.RELATIVE_TO_TOTAL:return n/i.TOTAL;case F.UNITARY:return n>0?1:0}}()})}));return Object(u["a"])(Object(u["a"])({},a),{},{score:i.reduce((function(t,e){return t+e.weight*e.score}),0),subGroups:i})}));return Object(u["a"])(Object(u["a"])({},t),{},{totalScore:a.reduce((function(t,e){return t+e.weight*e.score}),0),detailScore:a})})),a.scores=s.sort((function(t,e){return e.totalScore-t.totalScore}));case 5:case"end":return i.stop()}}),i)})))()}})},Lt=Nt,Rt=a("7496"),Ct=Object(nt["a"])(Lt,s,l,!1,null,null,null),jt=Ct.exports;lt()(Ct,{VApp:Rt["a"],VAppBar:d["a"],VBtn:T["a"],VCol:ot["a"],VContainer:m["a"],VDialog:z["a"],VFooter:g["a"],VIcon:y["a"],VMain:v["a"],VRow:ct["a"],VSlideYTransition:p["f"],VSpacer:b["a"],VTextField:h["a"],VToolbarTitle:f["a"]});a("4160"),a("b0c0"),a("159b");var kt=function(){return{fights:{},friendlies:[],enemies:[],tableEntries:{}}},Ft={},Mt={setReport:function(t,e){t.friendlies=[],t.fights={};for(var a=0;a<e.friendlies.length;a++){var i=e.friendlies[a];t.friendlies[i.id]=i}t.fights[x.OVERALL]={start_time:e.fights[0]["start_time"],end_time:e.fights[e.fights.length-1]["end_time"]};var r=new Set(Object.values(x));e.fights.forEach((function(e){var a=r.has(e.name)?e.name:"".concat(e.name,"-").concat(e.id);t.fights[a]=e})),t.fights[x.BEFORE_ONE]={start_time:t.fights[x.OVERALL].start_time+1,end_time:t.fights[x.ONE].start_time-1},t.fights[x.BEFORE_TWO]={start_time:t.fights[x.ONE].end_time+1,end_time:t.fights[x.TWO].start_time-1},t.fights[x.BEFORE_THREE]={start_time:t.fights[x.TWO].end_time+1,end_time:t.fights[x.THREE].start_time-1},t.fights[x.BEFORE_SIX]={start_time:t.fights[x.FIVE].end_time+1,end_time:t.fights[x.SIX].start_time-1},t.fights[x.BEFORE_SEVEN]={start_time:t.fights[x.SIX].end_time+1,end_time:t.fights[x.SEVEN].start_time-1},t.fights[x.BEFORE_EIGHT]={start_time:t.fights[x.SEVEN].end_time+1,end_time:t.fights[x.EIGHT].start_time-1}},setTableEntries:function(t,e){t.tableEntries=Object(u["a"])(Object(u["a"])({},t.tableEntries),e.map((function(t){var e=t.entries.filter((function(t){return"Warrior"===t.type}));return e.sort((function(t,e){return e.total-t.total})),Object(u["a"])(Object(u["a"])({},t),{},{entries:e,TOP:e.map((function(t){return t.total})).reduce((function(t,e){return e>t?e:t}),0),AVG:e.map((function(t){return t.total})).reduce((function(t,e){return t+e}),0)/t.entries.length,TOTAL:e.map((function(t){return t.total})).reduce((function(t,e){return t+e}),0)})})).reduce((function(t,e){return t[e.tableId]=e,t}),{}))}},Gt={},Bt={namespaced:!0,state:kt,getters:Ft,actions:Gt,mutations:Mt};i["default"].use(_["a"]);var Ut=new _["a"].Store({modules:{config:P,report:Bt}}),Dt=(a("bf40"),a("fcf4"));i["default"].config.productionTip=!1,i["default"].use(n.a),i["default"].use(_["a"]),new i["default"]({store:Ut,vuetify:new n.a({theme:{dark:!0,themes:{dark:{primary:Dt["a"].yellow.darken3,accent:Dt["a"].red.darken3}}}}),render:function(t){return t(jt)}}).$mount("#app")},"8e4e":function(t,e,a){}});
//# sourceMappingURL=app.6ab0bde6.js.map