(function(e){function t(t){for(var i,l,n=t[0],o=t[1],c=t[2],u=0,p=[];u<n.length;u++)l=n[u],Object.prototype.hasOwnProperty.call(r,l)&&r[l]&&p.push(r[l][0]),r[l]=0;for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i]);d&&d(t);while(p.length)p.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],i=!0,n=1;n<a.length;n++){var o=a[n];0!==r[o]&&(i=!1)}i&&(s.splice(t--,1),e=l(l.s=a[0]))}return e}var i={},r={app:0},s=[];function l(t){if(i[t])return i[t].exports;var a=i[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,l),a.l=!0,a.exports}l.m=e,l.c=i,l.d=function(e,t,a){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)l.d(a,i,function(t){return e[t]}.bind(null,i));return a},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],o=n.push.bind(n);n.push=t,n=n.slice();for(var c=0;c<n.length;c++)t(n[c]);var d=o;s.push([1,"chunk-vendors"]),a()})({0:function(e,t){},1:function(e,t,a){e.exports=a("56d7")},2:function(e,t){},3:function(e,t){},"31ed":function(e,t,a){"use strict";var i=a("8e4e"),r=a.n(i);r.a},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var i=a("2b0e"),r=a("ce5b"),s=a.n(r),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",[a("v-app-bar",{attrs:{app:""}},[a("v-toolbar-title",[e._v(" "+e._s(e.title)+" ")]),a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:function(t){e.openSetting=!e.openSetting}}},[a("v-icon",[e._v("mdi-settings-box")])],1)],1),a("v-main",[a("v-container",{attrs:{fluid:""}},[a("v-dialog",{attrs:{"max-width":"1000"},model:{value:e.openTable,callback:function(t){e.openTable=t},expression:"openTable"}},[a("wcl-table",{attrs:{table:e.table}})],1),a("v-slide-y-transition",[a("setting",{directives:[{name:"show",rawName:"v-show",value:e.openSetting,expression:"openSetting"}]})],1),a("v-row",{directives:[{name:"show",rawName:"v-show",value:!e.openSetting,expression:"!openSetting"}]},[a("v-col",{staticClass:"col-5 offset-3"},[a("v-text-field",{attrs:{loading:e.loading,disabled:e.loading,label:"wcl report id"},model:{value:e.reportId,callback:function(t){e.reportId=t},expression:"reportId"}})],1),a("v-col",{attrs:{"align-self":"center"}},[a("v-btn",{attrs:{disabled:e.loading},on:{click:e.fetchReport}},[e._v("Fetch")])],1)],1),!e.openSetting&&e.scores.length>0?[a("v-row",[a("v-tabs",{model:{value:e.selectedClassIndex,callback:function(t){e.selectedClassIndex=t},expression:"selectedClassIndex"}},[a("v-tabs-slider",{attrs:{color:"primary"}}),e._l(e.classes,(function(t){return a("v-tab",{key:t.code},[a("span",{style:{color:t.color}},[e._v(" "+e._s(t.display)+" ")])])}))],2)],1),a("v-row",[a("v-col",[a("score-table",{attrs:{scores:e.scores.find((function(t){return t.classType===e.selectedClass})).scores,"report-id":e.reportId,"class-type":e.selectedClass},on:{openTable:e.openTablePanel}})],1)],1)]:e._e()],2)],1),a("v-footer",{attrs:{app:""}},[e._v(" "+e._s(e.footer)+" ")])],1)},n=[],o=(a("99af"),a("4de4"),a("7db0"),a("a630"),a("a15b"),a("d81d"),a("13d5"),a("d3b7"),a("07ac"),a("6062"),a("3ca3"),a("ddb0"),a("2909")),c=(a("96cf"),a("1da1")),d=a("5530"),u=a("40dc"),p=a("2fa4"),b=a("0789"),m=a("2a7f"),f=a("a523"),T=a("f6c4"),v=a("553a"),h=a("8654"),g=a("8336"),y=a("132d"),O=a("2f62"),E="2dd31d65c33dabb5d269c9d24c4a14ed",S="api_key=".concat(E,"&translate=true"),_="https://cn.classic.warcraftlogs.com/v1",I={SUMMARY:"summary",DAMAGE:"damage-done",DAMAGE_TAKEN:"damage-taken",HEALING:"healing",CASTS:"casts",SUMMONS:"summons",BUFFS:"buffs",DEBUFFS:"debuffs",DEATHS:"deaths",SURVIVABILITY:"survivability",RESOURCES:"resources",RESOURCE_GAINS:"resources-gains"},A={OVERALL:"全程",BEFORE_ONE:"四狗+三鸡",ONE:"预言者斯克拉姆",BEFORE_TWO:"三宝前",TWO:"安其拉三宝",BEFORE_THREE:"通道虫",THREE:"沙尔图拉",BEFORE_FOUR:"陷阱房",FOUR:"顽强的范克瑞斯",FIVE:"维希度斯",BEFORE_SIX:"蜜蜂房",SIX:"哈霍兰公主",BEFORE_SEVEN:"五狗",SEVEN:"双子皇帝",BEFORE_EIGHT:"天堂之路",EIGHT:"奥罗",NINE:"克苏恩"},N={TOTAL:"total",HIT:"hitCount",BUFF_TOTAL:"totalUses"},V={total:"总数值",hitCount:"命中数",totalUses:"BUFF数"};function x(e){return R.apply(this,arguments)}function R(){return R=Object(c["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(_,"/report/fights/").concat(t,"?").concat(S));case 2:return a=e.sent,e.next=5,a.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)}))),R.apply(this,arguments)}function L(e,t,a,i,r,s){return w.apply(this,arguments)}function w(){return w=Object(c["a"])(regeneratorRuntime.mark((function e(t,a,i,r,s,l){var n,o,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=S,l["abilityId"]&&(n="".concat(n,"&abilityid=").concat(l["abilityId"])),l["customQuery"]&&(n="".concat(n,"&").concat(l["customQuery"])),e.next=5,fetch("".concat(_,"/report/tables/").concat(a,"/").concat(t,"?start=").concat(i,"&end=").concat(r,"&").concat(n));case 5:return o=e.sent,e.next=8,o.json();case 8:return c=e.sent,e.abrupt("return",(a===I.BUFFS?c["auras"]:c["entries"]).map((function(e){return Object(d["a"])(Object(d["a"])({},e),{},{total:e[s]})})));case 10:case"end":return e.stop()}}),e)}))),w.apply(this,arguments)}function C(e){var t;return Object.values((t=[]).concat.apply(t,Object(o["a"])(e)).reduce((function(e,t){return void 0===e[t.id]?e[t.id]=t:e[t.id].total+=t.total,e}),{}))}function F(e){var t;return Object.values((t=[]).concat.apply(t,Object(o["a"])(e)).reduce((function(e,t){return void 0===e[t.id]?e[t.id]=Object(d["a"])(Object(d["a"])({},t),{},{total:1}):e[t.id].total+=1,e}),{}))}var M={RELATIVE_TO_TOP:"to_top",RELATIVE_TO_MAX:"to_max",RELATIVE_TO_MIN:"to_min",RELATIVE_TO_AVG:"to_avg",RELATIVE_TO_TOTAL:"to_total",UNITARY:"unitary"},j={to_top:"相对于第一名",to_max:"相对于最大值",to_min:"达到最小值与否",to_avg:"相对于平均",to_total:"相对于总数",unitary:"转换成0或1"},k={classType:"Warrior",formulas:[{displayName:"熟练度",edit:!1,weight:.7,subGroups:[{tableIds:[{id:"DAMAGE",amplifier:1},{id:"TEAMMATE-DAMAGE",amplifier:-10}],weight:.67,type:M.RELATIVE_TO_TOP},{tableIds:[{id:"TRUE-SHOT-AURA",amplifier:1}],weight:.03,type:M.UNITARY,reverse:!0},{tableIds:[{id:"HEALING",amplifier:1}],type:M.RELATIVE_TO_TOP,weight:.1},{tableIds:[{id:"SUNDERS",amplifier:1}],weight:.2,type:M.RELATIVE_TO_TOP}]},{displayName:"战术",edit:!1,weight:.2,subGroups:[{tableIds:[{id:"death-wish-1",amplifier:1}],weight:.2,type:M.RELATIVE_TO_MAX,max:2},{tableIds:[{id:"death-wish-2",amplifier:1}],weight:.1,type:M.RELATIVE_TO_MAX,max:1},{tableIds:[{id:"death-wish-3",amplifier:1}],weight:.1,type:M.RELATIVE_TO_MAX,max:1},{tableIds:[{id:"death-wish-4",amplifier:1}],weight:.1,type:M.RELATIVE_TO_MAX,max:1},{tableIds:[{id:"death-wish-5",amplifier:1}],weight:.2,type:M.RELATIVE_TO_MAX,max:2},{tableIds:[{id:"27-BUGS-WARRIOR",amplifier:1}],weight:.1,type:M.RELATIVE_TO_MAX,max:2},{tableIds:[{id:"27-BUGS-NAIL",amplifier:1}],type:M.UNITARY,weight:.05},{tableIds:[{id:"BEE-ROOM-NAIL",amplifier:1}],type:M.UNITARY,weight:.05},{tableIds:[{id:"BOOM-BOX",amplifier:1}],type:M.UNITARY,weight:.05},{tableIds:[{id:"TRAP-ROOM-ACCELERATE",amplifier:1}],weight:.1,type:M.RELATIVE_TO_MAX,max:2},{tableIds:[{id:"BEE-ROOM-POTION",amplifier:1}],weight:.1,type:M.RELATIVE_TO_MAX,max:1}]},{displayName:"投入",edit:!1,weight:.1,subGroups:[{tableIds:[{id:"WORLD-BUFFS-MELEE",amplifier:1}],type:M.RELATIVE_TO_MAX,max:6,weight:.8},{tableIds:[{id:"petrification",amplifier:1}],type:M.UNITARY,weight:.1},{tableIds:[{id:"poison",amplifier:1}],type:M.RELATIVE_TO_TOP,weight:.1}]}]},G={classType:"Tank",formulas:[]},B={classType:"Shaman",formulas:[{displayName:"熟练度",edit:!1,weight:.7,subGroups:[{tableIds:[{id:"HEALING",amplifier:1},{id:"CTHUN-HEALING",amplifier:-1}],type:M.RELATIVE_TO_TOP,weight:.7},{tableIds:[{id:"WIND-TOTEM",amplifier:1}],type:M.RELATIVE_TO_TOP,checkShamanInRangeTeam:!0,inRangeTeamThreshold:10,weight:.1},{tableIds:[{id:"EARTH-TOTEM",amplifier:1}],type:M.RELATIVE_TO_TOP,checkShamanInRangeTeam:!0,inRangeTeamThreshold:10,weight:.1},{tableIds:[{id:"DAMAGE",amplifier:1}],type:M.RELATIVE_TO_MIN,min:5e4,weight:.02},{tableIds:[{id:"AOE-TOTEM",amplifier:1}],type:M.RELATIVE_TO_MIN,weight:.01,min:2},{tableIds:[{id:"27-BUGS-NAIL",amplifier:1}],type:M.UNITARY,weight:.01},{tableIds:[{id:"BEE-ROOM-NAIL",amplifier:1}],type:M.UNITARY,weight:.01},{tableIds:[{id:"BOOM-BOX",amplifier:1}],type:M.UNITARY,weight:.01},{tableIds:[{id:"VIS-FROST-SHOCK",amplifier:1}],type:M.RELATIVE_TO_MIN,min:5,weight:.2},{tableIds:[{id:"BOSS-ONE-TOTEM",amplifier:1}],type:M.UNITARY,weight:.01},{tableIds:[{id:"BEFORE-TWO-TOTEM",amplifier:1}],type:M.UNITARY,weight:.01}]},{displayName:"投入",edit:!1,weight:.3,subGroups:[{tableIds:[{id:"WORLD-BUFFS-RANGE",amplifier:1}],type:M.RELATIVE_TO_MAX,max:6,weight:.7},{tableIds:[{id:"petrification",amplifier:1}],type:M.UNITARY,weight:.1},{tableIds:[{id:"MANA-POISON",amplifier:1}],type:M.RELATIVE_TO_TOP,weight:.2}]}]},U={classType:"Mage",formulas:[]},D={classType:"Warlock",formulas:[]},P={classType:"Priest",formulas:[]},W={classType:"Druid",formulas:[]},H={classType:"Hunter",formulas:[]},Q={classType:"Paladin",formulas:[]},X={classType:"Rogue",formulas:[]},$=[k,G,B,U,D,P,W,H,Q,X];function Y(e){var t=e.reduce((function(e,t){return t.weight>0?e+t.weight:e}),0),a=e.map((function(e){var a=e.subGroups.reduce((function(e,t){return t.weight>0?e+t.weight:e}),0);return Object(d["a"])(Object(d["a"])({},e),{},{weight:e.weight/t,subGroups:e.subGroups.map((function(e){return Object(d["a"])(Object(d["a"])({},e),{},{weight:e.weight/a})}))})}));return a}var J=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",{staticClass:"settings",attrs:{elevation:"4",width:"100%"}},[a("v-toolbar",{scopedSlots:e._u([{key:"extension",fn:function(){return[a("v-tabs",{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tabs-slider",{attrs:{color:"primary"}}),a("v-tab",[e._v("表格")]),a("v-tab",[e._v("考核公式")])],1)]},proxy:!0}])},[a("v-toolbar-title",[e._v(" 设置 ")])],1),a("v-tabs-items",{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tab-item",[a("table-setting")],1),a("v-tab-item",[a("formula-setting")],1)],1)],1)},K=[],q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:""}},[a("v-dialog",{attrs:{"max-width":"400",persistent:""},model:{value:e.tableEditor,callback:function(t){e.tableEditor=t},expression:"tableEditor"}},[a("v-card",[a("v-card-title",[e._v("表格")]),a("v-card-text",[a("v-text-field",{attrs:{label:"表格名称"},model:{value:e.editTable.displayName,callback:function(t){e.$set(e.editTable,"displayName",t)},expression:"editTable.displayName"}}),a("v-select",{attrs:{label:"表格类型",items:e.tableTypeSelect},model:{value:e.editTable.tableName,callback:function(t){e.$set(e.editTable,"tableName",t)},expression:"editTable.tableName"}}),a("v-select",{attrs:{label:"战斗",items:e.fightSelect},model:{value:e.editTable.fights,callback:function(t){e.$set(e.editTable,"fights",t)},expression:"editTable.fights"}}),a("v-select",{attrs:{label:"表格列",items:e.columnSelect},model:{value:e.editTable.column,callback:function(t){e.$set(e.editTable,"column",t)},expression:"editTable.column"}}),a("v-text-field",{attrs:{label:"法术ID",rules:[function(){return 0===e.editTable.abilityIds.length||e.editTable.abilityIds.split(",").every((function(e){return!isNaN(parseInt(e))}))||"必须为以,隔开的数字"}]},model:{value:e.editTable.abilityIds,callback:function(t){e.$set(e.editTable,"abilityIds",t)},expression:"editTable.abilityIds"}}),a("v-text-field",{attrs:{label:"自定义参数"},model:{value:e.editTable.customQuery,callback:function(t){e.$set(e.editTable,"customQuery",t)},expression:"editTable.customQuery"}})],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary"},on:{click:e.saveTable}},[e._v("确定")]),a("v-btn",{on:{click:function(t){e.tableEditor=!1}}},[e._v("CLOSE")])],1)],1)],1),a("v-row",[a("v-col",[a("v-btn",{on:{click:e.newTable}},[a("v-icon",{attrs:{left:""}},[e._v(" mdi-plus ")]),e._v(" 添加表格")],1),a("v-btn",{staticClass:"ml-2",on:{click:e.resetTable}},[a("v-icon",{attrs:{left:""}},[e._v(" mdi-refresh ")]),e._v(" 重置")],1)],1)],1),a("v-row",[a("v-col",[a("v-simple-table",{attrs:{"fixed-header":""},scopedSlots:e._u([{key:"default",fn:function(){return[a("thead",[a("tr",[a("th",{staticClass:"text-left"},[e._v("表格名字")]),a("th",{staticClass:"text-left"},[e._v("表格类型")]),a("th",{staticClass:"text-left"},[e._v("战斗")]),a("th",{staticClass:"text-left"},[e._v("表格列")]),a("th",{staticClass:"text-left"},[e._v("法术ID")]),a("th",{staticClass:"text-left"},[e._v("自定义参数")]),a("th",{staticClass:"text-left",staticStyle:{width:"170px"}},[e._v("操作")])])]),a("tbody",e._l(e.tables,(function(t){return a("tr",{key:t.id},[a("td",{staticClass:"text-left"},[e._v(" "+e._s(t.displayName)+" ")]),a("td",{staticClass:"text-left"},[e._v(" "+e._s(t.tableName)+" ")]),a("td",{staticClass:"text-left"},[e._v(" "+e._s(t.fights)+" ")]),a("td",{staticClass:"text-left"},[e._v(" "+e._s(e.COLUMN_TEXT[t.column])+" ")]),a("td",{staticClass:"text-left"},[e._v(" "+e._s(void 0!==t.abilityIds?t.abilityIds.join(", "):"")+" ")]),a("td",{staticClass:"text-left"},[e._v(" "+e._s(t.customQuery)+" ")]),a("td",[a("v-btn",{on:{click:function(a){return e.edit(t)}}},[e._v("修改")]),t.predefined?e._e():a("v-btn",{staticClass:"ml-2",attrs:{color:"accent"},on:{click:function(a){return e.deleteTable(t.id)}}},[e._v("删除")])],1)])})),0)]},proxy:!0}])})],1)],1)],1)},z=[],Z=(a("ac1f"),a("1276"),a("ba0d")),ee=a("71d9"),te=a("b0af"),ae=a("99d9"),ie=a("1f4f"),re=a("b974"),se=a("169a"),le=a("fe57"),ne=a("9a96"),oe=a("71a3"),ce=a("ec26"),de={name:"TableSetting",comments:{VSlider:Z["a"],VIcon:y["a"],VContainer:f["a"],VToolbar:ee["a"],VToolbarTitle:m["a"],VCard:te["a"],VCardTitle:ae["c"],VCardActions:ae["a"],VCardText:ae["b"],VSimpleTable:ie["a"],VSelect:re["a"],VDialog:se["a"],VTabs:le["a"],VTabsSlider:ne["a"],VTab:oe["a"],VSpacer:p["a"]},data:function(){return{tableEditor:!1,tableTypeSelect:Object.values(I).map((function(e){return{text:e,value:e}})),fightSelect:Object.values(A).map((function(e){return{text:e,value:e}})),COLUMN_TEXT:V,columnSelect:Object.values(N).map((function(e){return{text:V[e],value:e}})),editTable:{predefined:!1,displayName:"",tableName:I.DAMAGE_TAKEN,fights:A.OVERALL,column:N.TOTAL,abilityIds:[],customQuery:""},editTableMode:"edit"}},computed:Object(d["a"])({},Object(O["c"])("config",["tables"])),methods:Object(d["a"])(Object(d["a"])({},Object(O["b"])("config",["insertTable","updateTable","deleteTable","resetTable"])),{},{edit:function(e){this.editTable=Object.assign({},e,{abilityIds:void 0!==e.abilityIds?e.abilityIds.join(","):""}),this.editTableMode="edit",this.tableEditor=!0},newTable:function(){this.editTable={id:Object(ce["a"])(),predefined:!1,displayName:"",tableName:I.DAMAGE_TAKEN,fights:A.OVERALL,column:N.TOTAL,abilityIds:"",customQuery:""},this.editTableMode="new",this.tableEditor=!0},saveTable:function(){"new"===this.editTableMode?this.insertTable(Object(d["a"])(Object(d["a"])({},this.editTable),{},{abilityIds:this.editTable.abilityIds.split(",")})):"edit"===this.editTableMode&&this.updateTable(Object(d["a"])(Object(d["a"])({},this.editTable),{},{abilityIds:this.editTable.abilityIds.split(",")})),this.tableEditor=!1}})},ue=de,pe=a("2877"),be=a("6544"),me=a.n(be),fe=a("62ad"),Te=a("0fd9"),ve=Object(pe["a"])(ue,q,z,!1,null,null,null),he=ve.exports;me()(ve,{VBtn:g["a"],VCard:te["a"],VCardActions:ae["a"],VCardText:ae["b"],VCardTitle:ae["c"],VCol:fe["a"],VContainer:f["a"],VDialog:se["a"],VIcon:y["a"],VRow:Te["a"],VSelect:re["a"],VSimpleTable:ie["a"],VSpacer:p["a"],VTextField:h["a"]});var ge=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:""}},[a("v-dialog",{attrs:{"max-width":"400",persistent:""},model:{value:e.formulaEditor,callback:function(t){e.formulaEditor=t},expression:"formulaEditor"}},[a("v-card",[a("v-card-title",[e._v("考核分组")]),a("v-card-text",[a("v-text-field",{attrs:{label:"计分组名称"},model:{value:e.editFormula.displayName,callback:function(t){e.$set(e.editFormula,"displayName",t)},expression:"editFormula.displayName"}})],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary"},on:{click:e.saveFormula}},[e._v("确定")]),a("v-btn",{on:{click:function(t){e.formulaEditor=!1}}},[e._v("CLOSE")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"400",persistent:""},model:{value:e.subgroupEditor,callback:function(t){e.subgroupEditor=t},expression:"subgroupEditor"}},[a("v-card",[a("v-card-title",[e._v("考核点")]),a("v-card-text",[a("div",{staticClass:"d-flex align-center"},[a("span",[e._v("表格相加")]),a("v-btn",{staticClass:"ml-2",attrs:{small:""},on:{click:e.addTable}},[a("v-icon",[e._v(" mdi-plus ")])],1)],1),a("div",{staticClass:"d-flex mb-5"},[a("div",{staticStyle:{width:"20px"}},[a("v-divider",{attrs:{vertical:""}})],1),a("div",{staticStyle:{flex:"1"}},e._l(e.editSubgroup.tableIds,(function(t,i){return a("v-row",{key:t.id},[a("v-col",{attrs:{cols:"2"}},[a("v-text-field",{attrs:{dense:"",label:"倍数",rules:[function(){return!isNaN(parseInt(t.amplifier))||"必须为整数"}]},model:{value:t.amplifier,callback:function(a){e.$set(t,"amplifier",a)},expression:"t.amplifier"}})],1),a("v-col",{attrs:{cols:"7"}},[a("v-select",{attrs:{dense:"",items:e.tableSelect},model:{value:t.id,callback:function(a){e.$set(t,"id",a)},expression:"t.id"}})],1),a("v-col",{attrs:{cols:"1"}},[a("v-btn",{attrs:{color:"accent",small:""},on:{click:function(t){return e.deleteTable(i)}}},[a("v-icon",[e._v(" mdi-delete ")])],1)],1)],1)})),1)]),a("v-select",{attrs:{label:"算分方式",items:e.typeSelect},model:{value:e.editSubgroup.type,callback:function(t){e.$set(e.editSubgroup,"type",t)},expression:"editSubgroup.type"}}),e.editSubgroup.type===e.FORMULA_TYPE.RELATIVE_TO_MAX?a("v-text-field",{attrs:{label:"预设最大值",rules:[function(){return!isNaN(parseInt(e.editSubgroup.max))||"必须为整数"}]},model:{value:e.editSubgroup.max,callback:function(t){e.$set(e.editSubgroup,"max",t)},expression:"editSubgroup.max"}}):e._e(),e.editSubgroup.type===e.FORMULA_TYPE.RELATIVE_TO_MIN?a("v-text-field",{attrs:{label:"预设最小值",rules:[function(){return!isNaN(parseInt(e.editSubgroup.min))||"必须为整数"}]},model:{value:e.editSubgroup.min,callback:function(t){e.$set(e.editSubgroup,"min",t)},expression:"editSubgroup.min"}}):e._e(),a("v-switch",{attrs:{label:"反向计分"},model:{value:e.editSubgroup.reverse,callback:function(t){e.$set(e.editSubgroup,"reverse",t)},expression:"editSubgroup.reverse"}})],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary"},on:{click:e.saveSubgroup}},[e._v("确定")]),a("v-btn",{on:{click:function(t){e.subgroupEditor=!1}}},[e._v("CLOSE")])],1)],1)],1),a("v-row",[a("v-tabs",{model:{value:e.selectedClassIndex,callback:function(t){e.selectedClassIndex=t},expression:"selectedClassIndex"}},[a("v-tabs-slider",{attrs:{color:"primary"}}),e._l(e.classes,(function(t){return a("v-tab",{key:t.code},[a("span",{style:{color:t.color}},[e._v(" "+e._s(t.display)+" ")])])}))],2)],1),a("v-row",[a("v-col",[a("v-btn",{on:{click:e.newFormula}},[a("v-icon",{attrs:{left:""}},[e._v(" mdi-plus ")]),e._v("添加组")],1),a("v-btn",{staticClass:"ml-2",on:{click:e.resetFormula}},[a("v-icon",{attrs:{left:""}},[e._v(" mdi-refresh ")]),e._v("重置")],1)],1)],1),a("v-row",[a("v-col",e._l(e.formulas,(function(t,i){return a("v-card",{key:i,staticClass:"mb-2",attrs:{elevation:"3"}},[a("v-card-title",{staticClass:"text--primary"},[a("v-row",[a("v-col",{staticClass:"col-1 d-flex align-center"},[t.edit?[a("v-text-field",{attrs:{"hide-details":"",dense:""},model:{value:t.displayName,callback:function(a){e.$set(t,"displayName",a)},expression:"group.displayName"}}),a("v-btn",{attrs:{icon:""},on:{click:function(e){t.edit=!1}}},[a("v-icon",[e._v("mdi-check")])],1)]:[e._v(" "+e._s(t.displayName)+" "),a("v-btn",{attrs:{icon:""},on:{click:function(e){t.edit=!0}}},[a("v-icon",[e._v(" mdi-pencil ")])],1)]],2),a("v-col",{staticClass:"col-2 py-0 align-center d-flex"},[a("v-slider",{attrs:{dense:"","hide-details":"",min:"-1",max:"1",step:"0.05",color:"primary"},model:{value:t.weight,callback:function(a){e.$set(t,"weight",a)},expression:"group.weight"}})],1),a("v-col",[e._v(" 比重: "+e._s(t.weight)+" ")]),a("v-col",{staticClass:"d-flex justify-end"},[a("v-btn",{attrs:{fab:"",small:"",color:"accent"},on:{click:function(t){return e.deleteFormula({classType:e.selectedClass,formulaIdx:i})}}},[a("v-icon",[e._v("mdi-delete")])],1)],1)],1)],1),a("v-card-text",[a("v-row",[a("v-col",[a("v-btn",{on:{click:function(t){return e.newSubgroup(i)}}},[a("v-icon",{attrs:{left:""}},[e._v(" mdi-plus ")]),e._v("添加计分")],1)],1)],1),a("v-row",[a("v-col",[a("v-simple-table",{scopedSlots:e._u([{key:"default",fn:function(){return[a("thead",[a("tr",[a("th",{staticStyle:{width:"400px"}},[e._v("表格")]),a("th",{staticStyle:{width:"150px"}},[e._v("算分方式")]),a("th",{staticStyle:{width:"100px"}},[e._v("预设值")]),a("th",{staticStyle:{width:"100px"}},[e._v("反向计分")]),a("th",[e._v("比重")]),a("th",{staticStyle:{width:"170px"}},[e._v("操作")])])]),a("tbody",e._l(t.subGroups,(function(t,r){return a("tr",{key:i+"_"+r},[a("td",[e._v(" "+e._s(t.tableIds.map((function(t){return(void 0!==t.amplifier?"("+t.amplifier+") x":"")+e.tables.find((function(e){return e.id===t.id})).displayName})).join(" + "))+" ")]),a("td",[e._v(e._s(e.FORMULA_TYPE_TEXT[t.type]))]),a("td",[e._v(e._s(t.max))]),a("td",[e._v(e._s(t.reverse))]),a("td",[a("v-row",[a("v-col",{staticClass:"col-1 d-flex align-center"},[e._v(e._s(t.weight))]),a("v-col",[a("v-slider",{attrs:{dense:"","hide-details":"",min:"-1",max:"1",step:"0.01",color:"primary"},model:{value:t.weight,callback:function(a){e.$set(t,"weight",a)},expression:"sub.weight"}})],1)],1)],1),a("td",[a("v-btn",{on:{click:function(t){return e.openEditSubgroup(i,r)}}},[e._v("修改")]),a("v-btn",{staticClass:"ml-2",attrs:{color:"accent"},on:{click:function(t){return e.deleteSubgroup({classType:e.selectedClass,formulaIdx:i,subgroupIdx:r})}}},[e._v("删除")])],1)])})),0)]},proxy:!0}],null,!0)})],1)],1)],1)],1)})),1)],1)],1)},ye=[],Oe=(a("a434"),a("ce7e")),Ee=a("b73d"),Se=[{code:"Warrior",display:"战士",color:"#c69b6d"},{code:"Tank",display:"防御战士",color:"#c69b6d"},{code:"Shaman",display:"萨满祭司",color:"#2359ff"},{code:"Mage",display:"法师",color:"#68ccef"},{code:"Warlock",display:"术士",color:"#9382c9"},{code:"Priest",display:"牧师",color:"#fff"},{code:"Druid",display:"德鲁伊",color:"#ff7c0a"},{code:"Hunter",display:"猎人",color:"#aad372"},{code:"Paladin",display:"圣骑士",color:"#f48cba"},{code:"Rogue",display:"潜行者",color:"#fff468"}],_e={name:"FormulaSetting",comments:{VDivider:Oe["a"],VSwitch:Ee["a"],VSlider:Z["a"],VIcon:y["a"],VContainer:f["a"],VToolbar:ee["a"],VToolbarTitle:m["a"],VCard:te["a"],VCardTitle:ae["c"],VCardActions:ae["a"],VCardText:ae["b"],VSimpleTable:ie["a"],VSelect:re["a"],VDialog:se["a"],VTabs:le["a"],VTabsSlider:ne["a"],VTab:oe["a"],VSpacer:p["a"]},data:function(){return{classes:Se,FORMULA_TYPE:M,selectedClassIndex:0,formulaEditor:!1,subgroupEditor:!1,typeSelect:Object.values(M).map((function(e){return{text:j[e],value:e}})),FORMULA_TYPE_TEXT:j,editFormula:{displayName:"",edit:!1,weight:1,subGroups:[]},editSubgroupIdx:{formulaIdx:-1,subgroupIdx:-1},editSubgroup:{tableIds:[{id:"DAMAGE",amplifier:1}],weight:1,type:M.RELATIVE_TO_TOP},editFormulaMode:"edit",editSubgroupMode:"edit"}},computed:Object(d["a"])(Object(d["a"])({},Object(O["c"])("config",["tables","allFormulas"])),{},{tableSelect:function(){return this.tables.map((function(e){return{text:e.displayName,value:e.id}}))},selectedClass:function(){return this.classes[this.selectedClassIndex].code},formulas:function(){var e=this,t=this.allFormulas.find((function(t){return t.classType===e.selectedClass}));return t["formulas"]}}),methods:Object(d["a"])(Object(d["a"])({},Object(O["b"])("config",["insertFormula","deleteFormula","resetFormula","insertSubgroup","updateSubgroup","deleteSubgroup"])),{},{openEditSubgroup:function(e,t){this.editSubgroup=Object.assign({},this.formulas[e].subGroups[t]),this.editSubgroupIdx={formulaIdx:e,subgroupIdx:t},this.editSubgroupMode="edit",this.subgroupEditor=!0},newFormula:function(){this.editFormula={displayName:"",edit:!1,weight:1,subGroups:[]},this.editFormulaMode="new",this.formulaEditor=!0},newSubgroup:function(e){this.editSubgroup={tableIds:[{id:"DAMAGE",amplifier:1}],weight:1,type:M.RELATIVE_TO_TOP},this.editSubgroupIdx.formulaIdx=e,this.editSubgroupMode="new",this.subgroupEditor=!0},addTable:function(){this.editSubgroup.tableIds.push({id:"DAMAGE",amplifier:1})},deleteTable:function(e){this.editSubgroup.tableIds.splice(e,1)},saveFormula:function(){this.insertFormula({classType:this.selectedClass,formula:this.editFormula}),this.formulaEditor=!1},saveSubgroup:function(){"new"===this.editSubgroupMode?this.insertSubgroup(Object(d["a"])(Object(d["a"])({classType:this.selectedClass},this.editSubgroupIdx),{},{newSubgroup:Object(d["a"])(Object(d["a"])({},this.editSubgroup),{},{max:parseInt(this.editSubgroup.max)})})):"edit"===this.editSubgroupMode&&this.updateSubgroup(Object(d["a"])(Object(d["a"])({classType:this.selectedClass},this.editSubgroupIdx),{},{subgroup:Object(d["a"])(Object(d["a"])({},this.editSubgroup),{},{max:parseInt(this.editSubgroup.max)})})),this.subgroupEditor=!1}})},Ie=_e,Ae=Object(pe["a"])(Ie,ge,ye,!1,null,null,null),Ne=Ae.exports;me()(Ae,{VBtn:g["a"],VCard:te["a"],VCardActions:ae["a"],VCardText:ae["b"],VCardTitle:ae["c"],VCol:fe["a"],VContainer:f["a"],VDialog:se["a"],VDivider:Oe["a"],VIcon:y["a"],VRow:Te["a"],VSelect:re["a"],VSimpleTable:ie["a"],VSlider:Z["a"],VSpacer:p["a"],VSwitch:Ee["a"],VTab:oe["a"],VTabs:le["a"],VTabsSlider:ne["a"],VTextField:h["a"]});var Ve={name:"Setting",components:{TableSetting:he,FormulaSetting:Ne,VToolbar:ee["a"],VToolbarTitle:m["a"],VCard:te["a"],VTabs:le["a"],VTabsSlider:ne["a"],VTab:oe["a"]},data:function(){return{tab:0}}},xe=Ve,Re=(a("31ed"),a("c671")),Le=a("aac8"),we=Object(pe["a"])(xe,J,K,!1,null,null,null),Ce=we.exports;me()(we,{VCard:te["a"],VTab:oe["a"],VTabItem:Re["a"],VTabs:le["a"],VTabsItems:Le["a"],VTabsSlider:ne["a"],VToolbar:ee["a"],VToolbarTitle:m["a"]});var Fe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-row",[a("v-col",[a("v-btn",{attrs:{small:""},on:{click:e.download}},[a("v-icon",[e._v("mdi-download")]),e._v(" XLXS ")],1)],1)],1),e.scores.length>0?[a("v-data-table",{staticClass:"elevation-1",attrs:{dense:"",headers:e.headers,items:e.items,"items-per-page":20,"hide-default-footer":""}})]:e._e(),a("v-list",{staticClass:"mt-5",attrs:{width:"100%"}},e._l(e.scores,(function(t){return a("v-list-group",{key:t.id,scopedSlots:e._u([{key:"activator",fn:function(){return[a("v-list-item-content",[a("v-list-item-title",[e._v(e._s(t.name)+" - "+e._s(Math.round(100*t.totalScore)/100))])],1)]},proxy:!0}],null,!0)},e._l(t.detailScore,(function(i,r){return a("v-list-group",{key:t.id+"-"+r,attrs:{"no-action":"","sub-group":""},scopedSlots:e._u([{key:"activator",fn:function(){return[a("v-list-item",[a("v-list-item-content",[a("v-list-item-title",[e._v(e._s(i.displayName)+" - "+e._s(Math.round(100*i.score)/100))])],1)],1)]},proxy:!0}],null,!0)},e._l(i.subGroups,(function(i,r){return a("v-list-item",{key:t.id+"-"+r,on:{click:function(t){return e.$emit("openTable",i.subgroupTable)}}},[a("v-list-item-content",[a("v-list-item-title",[e._v(e._s(i.tableName)+" - "+e._s(Math.round(100*i.score)/100))])],1)],1)})),1)})),1)})),1)],2)},Me=[],je=(a("4160"),a("c975"),a("b0c0"),a("159b"),a("8fea")),ke=a("8860"),Ge=a("56b0"),Be=a("da13"),Ue=a("5d23"),De=a("1146"),Pe=a.n(De),We={name:"ScoreTable",components:{VDataTable:je["a"],VList:ke["a"],VListGroup:Ge["a"],VListItem:Be["a"],VListItemContent:Ue["a"],VListItemTitle:Ue["b"]},props:{scores:{type:Array,required:!0},reportId:{type:String,required:!0},classType:{type:String,required:!0}},computed:{headers:function(){if(this.scores.length>0){var e=[{text:"名字",align:"start",sortable:!1,value:"name"},{text:"总分",value:"totalScore"}];return e.concat.apply(e,Object(o["a"])(this.scores[0].detailScore.map((function(e){var t,a={text:e.displayName,value:"group-".concat(e.displayName),weight:e.weight},i=e.subGroups.map((function(e){return{text:e.tableName,value:"sub-".concat(e.tableName),weight:e.weight}}));return(t=[a]).concat.apply(t,Object(o["a"])(i))}))))}return[]},items:function(){return this.scores.map((function(e){var t={name:e.name,totalScore:Math.round(100*e.totalScore)/100};return e.detailScore.reduce((function(e,t){return e["group-".concat(t.displayName)]=Math.round(100*t.score)/100,t.subGroups.reduce((function(e,t){return e["sub-".concat(t.tableName)]=Math.round(100*t.score)/100,e}),e),e}),t),t}))}},methods:{download:function(){for(var e=this,t="".concat(this.reportId,".xlsx"),a=this.headers.map((function(e){return e.text})),i=this.items.map((function(t){return e.headers.map((function(e){return t[e.value]}))})),r=[a].concat(i),s=Pe.a.utils.book_new(),l=Pe.a.utils.aoa_to_sheet(r),n=[],o=null,c=2;c<this.headers.length;c++){var d=this.headers[c];0===d.value.indexOf("group")?(o={idx:c,weight:d.weight,subLayers:[]},n.push(o)):0===d.value.indexOf("sub")&&o.subLayers.push({idx:c,weight:d.weight})}var u=n.map((function(e){return"".concat(String.fromCharCode(65+e.idx),"{playerIdx}*").concat(e.weight)})).join("+"),p="ROUND(".concat(u,",3)"),b=n.map((function(e){var t=e.subLayers.map((function(e){return"".concat(String.fromCharCode(65+e.idx),"{playerIdx}*").concat(e.weight)})).join("+");return{idx:e.idx,formula:"ROUND(".concat(t,",3)")}}));this.items.map((function(e,t){var a="B".concat(t+2);l[a]={f:p.replaceAll("{playerIdx}",t+2)},b.forEach((function(e){var a="".concat(String.fromCharCode(65+e.idx)).concat(t+2);l[a]={f:e.formula.replaceAll("{playerIdx}",t+2)}}))})),console.log(l),Pe.a.utils.book_append_sheet(s,l,this.classType),Pe.a.writeFile(s,t)}}},He=We,Qe=Object(pe["a"])(He,Fe,Me,!1,null,null,null),Xe=Qe.exports;me()(Qe,{VBtn:g["a"],VCol:fe["a"],VDataTable:je["a"],VIcon:y["a"],VList:ke["a"],VListGroup:Ge["a"],VListItem:Be["a"],VListItemContent:Ue["a"],VListItemTitle:Ue["b"],VRow:Te["a"]});var $e=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",{staticClass:"settings",attrs:{elevation:"4",width:"100%",height:"100%"}},[a("v-toolbar",[a("v-toolbar-title",[e._v(" "+e._s(e.table.tableName)+" ")])],1),a("v-container",{attrs:{fluid:""}},[a("v-simple-table",{attrs:{"fixed-header":"",height:"500px"},scopedSlots:e._u([{key:"default",fn:function(){return[a("thead",[a("tr",[a("th",{staticClass:"text-left"},[e._v("名字")]),a("th",{staticClass:"text-left"},[e._v("百分条")]),a("th",{staticClass:"text-left"},[e._v("数值")])])]),a("tbody",e._l(e.table.entries,(function(t){return a("tr",{key:t.id},[a("td",[e._v(e._s(t.name))]),a("td",{staticStyle:{width:"600px"}},[a("div",{staticClass:"primary",staticStyle:{height:"25px"},style:{width:t.total/e.table.TOP*580+"px"}})]),a("td",[e._v(e._s(t.total))])])})),0)]},proxy:!0}])})],1)],1)},Ye=[],Je={name:"WclTable",components:{VContainer:f["a"],VToolbar:ee["a"],VToolbarTitle:m["a"],VSimpleTable:ie["a"],VCard:te["a"]},props:{table:{type:Object,required:!0}},methods:{}},Ke=Je,qe=Object(pe["a"])(Ke,$e,Ye,!1,null,null,null),ze=qe.exports;me()(qe,{VCard:te["a"],VContainer:f["a"],VSimpleTable:ie["a"],VToolbar:ee["a"],VToolbarTitle:m["a"]});var Ze=[{id:"DAMAGE",predefined:!0,displayName:"全程伤害",tableName:I.DAMAGE,fights:A.OVERALL,column:N.TOTAL,abilityIds:[],customQuery:""},{id:"TEAMMATE-DAMAGE",predefined:!0,displayName:"队友误伤",tableName:I.DAMAGE_TAKEN,fights:A.OVERALL,column:N.TOTAL,abilityIds:[],customQuery:"hostility=1&sourceclass=Player&target=Player&by=target"},{id:"27-BUGS-WARRIOR",predefined:!0,displayName:"27虫群嘲无敌",tableName:I.CASTS,fights:A.BEFORE_THREE,column:N.TOTAL,abilityIds:[1161,3169],customQuery:""},{id:"27-BUGS-NAIL",predefined:!0,displayName:"通道钉子",tableName:I.DAMAGE,fights:A.BEFORE_THREE,column:N.TOTAL,abilityIds:[17669]},{id:"BEE-ROOM-NAIL",predefined:!0,displayName:"蜜蜂房钉子",tableName:I.DAMAGE,fights:A.BEFORE_SIX,column:N.TOTAL,abilityIds:[17669]},{id:"BOOM-BOX",predefined:!0,displayName:"地精炸弹箱",tableName:I.CASTS,fights:A.OVERALL,column:N.TOTAL,abilityIds:[23134]},{id:"AOE-TOTEM",predefined:!0,displayName:"萨满AOE图腾",tableName:I.CASTS,fights:A.OVERALL,column:N.TOTAL,abilityIds:[11315,10587]},{id:"EARTH-TOTEM",predefined:!0,displayName:"萨满大地战栗图腾",tableName:I.CASTS,fights:A.OVERALL,column:N.TOTAL,abilityIds:[25361,8143]},{id:"WIND-TOTEM",predefined:!0,displayName:"萨满风怒图腾",tableName:I.CASTS,fights:A.OVERALL,column:N.TOTAL,abilityIds:[10614]},{id:"BOSS-ONE-TOTEM",predefined:!0,displayName:"老1根基图腾",tableName:I.CASTS,fights:A.ONE,column:N.TOTAL,abilityIds:[8177]},{id:"BEFORE-TWO-TOTEM",predefined:!0,displayName:"三宝前根基图腾",tableName:I.CASTS,fights:A.BEFORE_TWO,column:N.TOTAL,abilityIds:[8177]},{id:"VIS-FROST-SHOCK",predefined:!0,displayName:"小软冰霜震击",tableName:I.CASTS,fights:A.FIVE,column:N.TOTAL,abilityIds:[8056]},{id:"TRAP-ROOM-ACCELERATE",predefined:!0,displayName:"陷阱房加速",tableName:I.CASTS,fights:A.BEFORE_FOUR,column:N.TOTAL,abilityIds:[9175,14530],customQuery:""},{id:"BEE-ROOM-POTION",predefined:!0,displayName:"蜜蜂房自由",tableName:I.CASTS,fights:A.BEFORE_SIX,column:N.TOTAL,abilityIds:[6615],customQuery:""},{id:"MANA-POISON",predefined:!0,displayName:"全程大蓝符文",tableName:I.CASTS,fights:A.OVERALL,column:N.TOTAL,abilityIds:[16666,17531,27869],customQuery:""},{id:"DAMAGE-TAKEN",predefined:!0,displayName:"全程承伤",tableName:I.DAMAGE_TAKEN,fights:A.OVERALL,column:N.TOTAL,abilityIds:[],customQuery:""},{id:"HEALING",predefined:!0,displayName:"全程治疗",tableName:I.HEALING,fights:A.OVERALL,column:N.TOTAL,abilityIds:[],customQuery:""},{id:"CTHUN-HEALING",predefined:!0,displayName:"克苏恩治疗",tableName:I.HEALING,fights:A.NINE,column:N.TOTAL,abilityIds:[],customQuery:""},{id:"WORLD-BUFFS-MELEE",predefined:!0,displayName:"世界BUFFS",tableName:I.BUFFS,fights:A.OVERALL,column:N.BUFF_TOTAL,abilityIds:[15366,22888,22818,24425,22817,16609],customQuery:""},{id:"WORLD-BUFFS-RANGE",predefined:!0,displayName:"世界BUFFS",tableName:I.BUFFS,fights:A.OVERALL,column:N.BUFF_TOTAL,abilityIds:[15366,22888,22818,24425,22820,16609],customQuery:""},{id:"TRUE-SHOT-AURA",predefined:!0,displayName:"强击光环",tableName:I.BUFFS,fights:A.OVERALL,column:N.BUFF_TOTAL,abilityIds:[20906]},{id:"DUMMY-TARGET",predefined:!0,displayName:"高级活动假人",tableName:I.CASTS,fights:A.OVERALL,column:N.TOTAL,abilityIds:[19805],customQuery:""},{id:"SUNDERS",predefined:!0,displayName:"破甲",tableName:I.CASTS,fights:A.OVERALL,column:N.TOTAL,abilityIds:[11597],customQuery:""},{id:"VIS",predefined:!0,displayName:"维希度斯冰箭",tableName:I.DAMAGE,fights:A.FIVE,column:N.HIT,abilityIds:[13439,205],customQuery:""},{id:"petrification",predefined:!0,displayName:"化石",tableName:I.CASTS,fights:A.OVERALL,column:N.TOTAL,abilityIds:[17624],customQuery:""},{id:"poison",predefined:!0,displayName:"抗毒药剂",tableName:I.CASTS,fights:A.OVERALL,column:N.TOTAL,abilityIds:[26677],customQuery:""},{id:"death-wish-1",predefined:!0,displayName:"老1前死愿+鲁莽",tableName:I.CASTS,fights:A.BEFORE_ONE,column:N.TOTAL,abilityIds:[12328,-1719],customQuery:""},{id:"death-wish-2",predefined:!0,displayName:"三宝前死愿",tableName:I.CASTS,fights:A.BEFORE_TWO,column:N.TOTAL,abilityIds:[12328],customQuery:""},{id:"death-wish-3",predefined:!0,displayName:"沙尔图拉死愿",tableName:I.CASTS,fights:A.THREE,column:N.TOTAL,abilityIds:[12328],customQuery:""},{id:"death-wish-4",predefined:!0,displayName:"哈霍兰死愿",tableName:I.CASTS,fights:A.SIX,column:N.TOTAL,abilityIds:[12328],customQuery:""},{id:"death-wish-5",predefined:!0,displayName:"奥罗死愿鲁莽",tableName:I.CASTS,fights:A.EIGHT,column:N.TOTAL,abilityIds:[12328,-1719],customQuery:""}];function et(e,t){return Object.values(e).map((function(e){return Object(d["a"])(Object(d["a"])({},e),{},{entries:e.entries.filter((function(e){return t.has(e.id)}))})})).reduce((function(e,t){return e[t.tableId]=t,e}),{})}var tt={name:"App",components:{ScoreTable:Xe,VAppBar:u["a"],VSpacer:p["a"],VSlideYTransition:b["g"],VToolbarTitle:m["a"],VContainer:f["a"],VMain:T["a"],VFooter:v["a"],VTextField:h["a"],VBtn:g["a"],Setting:Ce,WclTable:ze,VIcon:y["a"]},data:function(){return{openSetting:!1,openTable:!1,table:{},loading:!1,title:"Classic WCL Analyzer",footer:"Powered by To God be the Glory",reportId:"pKCJrHR8BfX3N1hk",selectedClassIndex:0,classes:Se,scores:[]}},computed:Object(d["a"])(Object(d["a"])(Object(d["a"])({},Object(O["c"])("config",["tables","allFormulas"])),Object(O["c"])("report",["friendlies","fights","tableEntries"])),{},{selectedClass:function(){return this.classes[this.selectedClassIndex].code}}),watch:{openSetting:function(){this.save()}},methods:Object(d["a"])(Object(d["a"])(Object(d["a"])({},Object(O["b"])("report",["setReport","setTableEntries","setFriendlies"])),Object(O["b"])("config",["save"])),{},{openTablePanel:function(e){this.openTable=!0,this.table=e},fetchReport:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var a,i,r,s,l,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,x(e.reportId);case 3:return s=t.sent,e.setReport(s),t.next=7,L(e.reportId,I.DAMAGE_TAKEN,e.fights[A.OVERALL].start_time,e.fights[A.OVERALL].end_time,N.TOTAL,{abilityId:"1"});case 7:return l=t.sent,e.setFriendlies(l),n=new Set((a=[]).concat.apply(a,Object(o["a"])((i=[]).concat.apply(i,Object(o["a"])((r=[]).concat.apply(r,Object(o["a"])(e.allFormulas.map((function(e){return e.formulas})))).map((function(e){return e.subGroups})))).map((function(e){return e.tableIds.map((function(e){return e.id}))}))))),t.next=12,e.fetchTables(Array.from(n));case 12:return t.next=14,e.calcScores();case 14:e.loading=!1;case 15:case"end":return t.stop()}}),t)})))()},fetchTables:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Promise.all(e.map(function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(a){var i,r,s,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i=t.tables.find((function(e){return e.id===a})),r=t.fights[i.fights],!(i.abilityIds.length>0)){e.next=9;break}return e.next=5,Promise.all(i.abilityIds.map((function(e){return L(t.reportId,i.tableName,r["start_time"],r["end_time"],i.column,{abilityId:e,customQuery:i.customQuery})})));case 5:return s=e.sent,e.abrupt("return",{tableId:a,tableName:i.displayName,entries:"WORLD-BUFFS-MELEE"===a||"WORLD-BUFFS-RANGE"===a?F(s):C(s)});case 9:return e.next=11,L(t.reportId,i.tableName,r["start_time"],r["end_time"],i.column,{customQuery:i.customQuery});case 11:return l=e.sent,e.abrupt("return",{tableId:a,tableName:i.displayName,entries:l});case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:i=a.sent,t.setTableEntries(i);case 4:case"end":return a.stop()}}),a)})))()},calcScores:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.scores=e.allFormulas.map((function(t){var a=t.classType,i=t.formulas,r=Y(i),s=e.friendlies.filter((function(e){return e.type===a})),l=et(e.tableEntries,new Set(s.map((function(e){return e.id})))),n=r.map((function(t){return Object(d["a"])(Object(d["a"])({},t),{},{subGroups:t.subGroups.map((function(t){for(var a={},i=function(e){var i=t.tableIds[e],r=l[i.id].entries;r.reduce((function(e,t){return void 0===e[t.id]?(e[t.id]=t,e[t.id]["total"]=t["total"]*i["amplifier"]):e[t.id]["total"]=e[t.id]["total"]+t["total"]*i["amplifier"],e}),a)},r=0;r<t.tableIds.length;r++)i(r);var s=Object.values(a).sort((function(e,t){return t.total-e.total})),n=t.tableIds.map((function(t){return"".concat(void 0!==t.amplifier?"("+t.amplifier+")  x":"").concat(e.tables.find((function(e){return e.id===t.id})).displayName)})).join(" + "),o=s.map((function(e){return e.total})).reduce((function(e,t){return e+t}),0),c=o/s.entries.length,u=s.map((function(e){return e.total})).reduce((function(e,t){return t>e?t:e}),0);return Object(d["a"])(Object(d["a"])({},t),{},{subgroupTable:{entries:s,tableName:n,TOTAL:o,AVG:c,TOP:u}})}))})})),o=s.map((function(e){var t=n.map((function(t){var a=t.subGroups.map((function(t){return Object(d["a"])(Object(d["a"])({},t),{},{tableName:t.subgroupTable.tableName,score:function(){var a=t.subgroupTable,i=a.entries.find((function(t){return t.id===e.id})),r=void 0===i?0:i.total,s=0;if(t.checkShamanInRangeTeam&&r<t.inRangeTeamThreshold)s=1;else switch(t.type){case M.RELATIVE_TO_MAX:s=Math.min(r,t.max)/t.max;break;case M.RELATIVE_TO_MIN:s=r>=t.min?1:0;break;case M.RELATIVE_TO_TOP:s=r/a.TOP;break;case M.RELATIVE_TO_AVG:s=r/a.AVG;break;case M.RELATIVE_TO_TOTAL:s=r/a.TOTAL;break;case M.UNITARY:s=r>0?1:0;break}return t.reverse?1-s:s}()})}));return Object(d["a"])(Object(d["a"])({},t),{},{score:a.reduce((function(e,t){return e+t.weight*t.score}),0),subGroups:a})}));return Object(d["a"])(Object(d["a"])({},e),{},{totalScore:t.reduce((function(e,t){return e+t.weight*t.score}),0),detailScore:t})}));return o.sort((function(e,t){return t.totalScore-e.totalScore})),{classType:a,scores:o}}));case 1:case"end":return t.stop()}}),t)})))()}})},at=tt,it=a("7496"),rt=Object(pe["a"])(at,l,n,!1,null,null,null),st=rt.exports;me()(rt,{VApp:it["a"],VAppBar:u["a"],VBtn:g["a"],VCol:fe["a"],VContainer:f["a"],VDialog:se["a"],VFooter:v["a"],VIcon:y["a"],VMain:T["a"],VRow:Te["a"],VSlideYTransition:b["g"],VSpacer:p["a"],VTab:oe["a"],VTabs:le["a"],VTabsSlider:ne["a"],VTextField:h["a"],VToolbarTitle:m["a"]});a("c740"),a("fb6a");var lt=function(){return{tables:localStorage.getItem("gloryWCLSetting-tables")?JSON.parse(localStorage.getItem("gloryWCLSetting-tables")):Ze.slice(),allFormulas:localStorage.getItem("gloryWCLSetting-formulas")?JSON.parse(localStorage.getItem("gloryWCLSetting-formulas")):$.slice()}},nt={},ot={},ct={save:function(e){localStorage.setItem("gloryWCLSetting-tables",JSON.stringify(e.tables)),localStorage.setItem("gloryWCLSetting-formulas",JSON.stringify(e.allFormulas))},updateTable:function(e,t){var a=e.tables.findIndex((function(e){return e.id===t.id}));i["default"].set(e.tables,a,t),localStorage.setItem("gloryWCLSetting-tables",JSON.stringify(e.tables))},insertTable:function(e,t){e.tables.push(t),localStorage.setItem("gloryWCLSetting-tables",JSON.stringify(e.tables))},deleteTable:function(e,t){var a=e.tables.findIndex((function(e){return e.id===t}));e.tables.splice(a,1),localStorage.setItem("gloryWCLSetting-tables",JSON.stringify(e.tables))},resetTable:function(e){e.tables=Ze.slice(),localStorage.setItem("gloryWCLSetting-tables",JSON.stringify(e.tables))},insertFormula:function(e,t){var a=t.classType,i=t.formula;e.allFormulas.find((function(e){return e.classType===a}))["formulas"].unshift(i),localStorage.setItem("gloryWCLSetting-formulas",JSON.stringify(e.allFormulas))},deleteFormula:function(e,t){var a=t.classType,i=t.formulaIdx;e.allFormulas.find((function(e){return e.classType===a}))["formulas"].splice(i,1),localStorage.setItem("gloryWCLSetting-formulas",JSON.stringify(e.allFormulas))},resetFormula:function(e){e.allFormulas=$.slice(),localStorage.setItem("gloryWCLSetting-formulas",JSON.stringify(e.allFormulas))},insertSubgroup:function(e,t){var a=t.classType,i=t.formulaIdx,r=t.newSubgroup;e.allFormulas.find((function(e){return e.classType===a}))["formulas"][i].subGroups.unshift(r),localStorage.setItem("gloryWCLSetting-formulas",JSON.stringify(e.allFormulas))},updateSubgroup:function(e,t){var a=t.classType,r=t.formulaIdx,s=t.subgroupIdx,l=t.subgroup;i["default"].set(e.allFormulas.find((function(e){return e.classType===a}))["formulas"][r].subGroups,s,l),localStorage.setItem("gloryWCLSetting-formulas",JSON.stringify(e.allFormulas))},deleteSubgroup:function(e,t){var a=t.classType,i=t.formulaIdx,r=t.subgroupIdx;e.allFormulas.find((function(e){return e.classType===a}))["formulas"][i].subGroups.splice(r,1),localStorage.setItem("gloryWCLSetting-formulas",e.allFormulas)}},dt={namespaced:!0,state:lt,getters:nt,actions:ot,mutations:ct},ut=function(){return{fights:{},friendlies:[],enemies:[],tableEntries:{}}},pt={},bt={setFriendlies:function(e,t){var a=new Set(t.sort((function(e,t){return t["total"]-e["total"]})).splice(0,3).map((function(e){return e["id"]})));e.friendlies=e.friendlies.map((function(e){return Object(d["a"])(Object(d["a"])({},e),{},{type:a.has(e["id"])?"Tank":e["type"]})}))},setReport:function(e,t){e.friendlies=[],e.fights={};for(var a=0;a<t.friendlies.length;a++){var i=t.friendlies[a];e.friendlies[i.id]=i}e.fights[A.OVERALL]={start_time:t.fights[0]["start_time"],end_time:t.fights[t.fights.length-1]["end_time"]};var r=new Set(Object.values(A));t.fights.forEach((function(t){var a=r.has(t.name)?t.name:"".concat(t.name,"-").concat(t.id);e.fights[a]=t})),e.fights[A.BEFORE_ONE]={start_time:e.fights[A.OVERALL].start_time+1,end_time:e.fights[A.ONE].start_time-1},e.fights[A.BEFORE_TWO]={start_time:e.fights[A.ONE].end_time+1,end_time:e.fights[A.TWO].start_time-1},e.fights[A.BEFORE_THREE]={start_time:e.fights[A.TWO].end_time+1,end_time:e.fights[A.THREE].start_time-1},e.fights[A.BEFORE_FOUR]={start_time:e.fights[A.THREE].end_time+1,end_time:e.fights[A.FOUR].start_time-1},e.fights[A.BEFORE_SIX]={start_time:e.fights[A.FIVE].end_time+1,end_time:e.fights[A.SIX].start_time-1},e.fights[A.BEFORE_SEVEN]={start_time:e.fights[A.SIX].end_time+1,end_time:e.fights[A.SEVEN].start_time-1},e.fights[A.BEFORE_EIGHT]={start_time:e.fights[A.SEVEN].end_time+1,end_time:e.fights[A.EIGHT].start_time-1}},setTableEntries:function(e,t){e.tableEntries=Object(d["a"])(Object(d["a"])({},e.tableEntries),t.reduce((function(e,t){return e[t.tableId]=t,e}),{}))}},mt={},ft={namespaced:!0,state:ut,getters:pt,actions:mt,mutations:bt};i["default"].use(O["a"]);var Tt=new O["a"].Store({modules:{config:dt,report:ft}}),vt=(a("bf40"),a("fcf4"));i["default"].config.productionTip=!1,i["default"].use(s.a),i["default"].use(O["a"]),new i["default"]({store:Tt,vuetify:new s.a({theme:{dark:!0,themes:{dark:{primary:vt["a"].yellow.darken3,accent:vt["a"].red.darken3}}}}),render:function(e){return e(st)}}).$mount("#app")},"8e4e":function(e,t,a){}});
//# sourceMappingURL=app.146ef259.js.map